<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Kunjungan Rumah - Usia Dewasa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }
        .form-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section-title {
            color: #1e40af;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 0.5rem;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen py-8">
    <div class="max-w-4xl mx-auto px-4">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-blue-800 mb-2">CHECKLIST KUNJUNGAN RUMAH</h1>
            <h2 class="text-xl font-semibold text-blue-600">USIA DEWASA (≥ 18 - 59 TAHUN)</h2>
            <p class="text-gray-600 mt-2">Berikan tanda centang (√) jika YA dan tanda silang (X) jika TIDAK</p>
        </div>

        <form id="checklistForm" class="space-y-6">
            <!-- Data Dasar -->
            <div class="form-section">
                <h3 class="section-title">Data Dasar</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Desa</label>
                        <select name="namaDesa" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih Desa</option>
                            <option value="Desa Ganra">Desa Ganra</option>
                            <option value="Desa Enrekeng">Desa Enrekeng</option>
                            <option value="Desa Belo">Desa Belo</option>
                            <option value="Desa Lompulle">Desa Lompulle</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Posyandu</label>
                        <input type="text" name="namaPosyandu" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Kader</label>
                        <input type="text" name="namaKader" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Lengkap</label>
                        <input type="text" name="namaLengkap" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal Lahir</label>
                        <input type="date" name="tanggalLahir" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Jenis Kelamin</label>
                        <select name="jenisKelamin" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="Laki-laki">Laki-laki</option>
                            <option value="Perempuan">Perempuan</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Riwayat Penyakit -->
            <div class="form-section">
                <h3 class="section-title">Riwayat Penyakit</h3>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Riwayat Penyakit Keluarga</label>
                    <div class="checkbox-group">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatKeluarga" value="Hipertensi" class="rounded text-blue-600">
                            <span>Hipertensi</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatKeluarga" value="Diabetes Mellitus" class="rounded text-blue-600">
                            <span>Diabetes Mellitus</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatKeluarga" value="Stroke" class="rounded text-blue-600">
                            <span>Stroke</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatKeluarga" value="Jantung" class="rounded text-blue-600">
                            <span>Jantung</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatKeluarga" value="Asma" class="rounded text-blue-600">
                            <span>Asma</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatKeluarga" value="Kolesterol Tinggi" class="rounded text-blue-600">
                            <span>Kolesterol Tinggi</span>
                        </label>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Riwayat Penyakit Pribadi</label>
                    <div class="checkbox-group">
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatPribadi" value="Hipertensi" class="rounded text-blue-600">
                            <span>Hipertensi</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatPribadi" value="Diabetes Mellitus" class="rounded text-blue-600">
                            <span>Diabetes Mellitus</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatPribadi" value="Stroke" class="rounded text-blue-600">
                            <span>Stroke</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatPribadi" value="Jantung" class="rounded text-blue-600">
                            <span>Jantung</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatPribadi" value="Asma" class="rounded text-blue-600">
                            <span>Asma</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" name="riwayatPribadi" value="Kolesterol Tinggi" class="rounded text-blue-600">
                            <span>Kolesterol Tinggi</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Kunjungan -->
            <div class="form-section">
                <h3 class="section-title">Data Kunjungan</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Waktu Kunjungan</label>
                        <select name="waktuKunjungan" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih Kunjungan</option>
                            <option value="Kunjungan 1">Kunjungan 1</option>
                            <option value="Kunjungan 2">Kunjungan 2</option>
                            <option value="Kunjungan 3">Kunjungan 3</option>
                            <option value="Kunjungan 4">Kunjungan 4</option>
                            <option value="Kunjungan 5">Kunjungan 5</option>
                            <option value="Kunjungan 6">Kunjungan 6</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal Kunjungan</label>
                        <input type="date" name="tanggalKunjungan" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Skrining Demam</label>
                        <select name="skriningDemam" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="<37,5°C"><37,5°C</option>
                            <option value=">37,5°C">>37,5°C</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Skrining Status Gizi -->
            <div class="form-section">
                <h3 class="section-title">Riwayat Skrining Status Gizi (BB, TB, LP, LiLA)</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                        <input type="date" name="tanggalGizi" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tempat</label>
                        <input type="text" name="tempatGizi" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Hasil</label>
                        <select name="hasilGizi" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="Normal">Normal</option>
                            <option value="Tidak Normal">Tidak Normal</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Skrining Indera -->
            <div class="form-section">
                <h3 class="section-title">Riwayat Skrining Indera (6 bulan terakhir)</h3>
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Skrining Penglihatan</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="date" name="tanggalPenglihatan" placeholder="Tanggal" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="tempatPenglihatan" placeholder="Tempat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <select name="hasilPenglihatan" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Hasil</option>
                            <option value="Normal">Normal</option>
                            <option value="Tidak Normal">Tidak Normal</option>
                        </select>
                    </div>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700 mb-2">Skrining Pendengaran</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="date" name="tanggalPendengaran" placeholder="Tanggal" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="tempatPendengaran" placeholder="Tempat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <select name="hasilPendengaran" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Hasil</option>
                            <option value="Normal">Normal</option>
                            <option value="Tidak Normal">Tidak Normal</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Pemeriksaan Lainnya -->
            <div class="form-section">
                <h3 class="section-title">Riwayat Pemeriksaan Kesehatan</h3>
                
                <!-- Tekanan Darah -->
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Pemeriksaan Tekanan Darah</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="date" name="tanggalTensi" placeholder="Tanggal" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="tempatTensi" placeholder="Tempat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <select name="hasilTensi" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Hasil</option>
                            <option value="Normal">Normal</option>
                            <option value="Tidak Normal">Tidak Normal</option>
                        </select>
                    </div>
                </div>

                <!-- Gula Darah -->
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Skrining Gula Darah</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="date" name="tanggalGulaDarah" placeholder="Tanggal" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="tempatGulaDarah" placeholder="Tempat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <select name="hasilGulaDarah" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Hasil</option>
                            <option value="Normal">Normal</option>
                            <option value="Tidak Normal">Tidak Normal</option>
                        </select>
                    </div>
                </div>

                <!-- PPOK/PUMA -->
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Skrining PPOK/PUMA (perokok >40 tahun)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="date" name="tanggalPPOK" placeholder="Tanggal" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="tempatPPOK" placeholder="Tempat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <select name="hasilPPOK" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Hasil</option>
                            <option value="Normal">Normal</option>
                            <option value="Tidak Normal">Tidak Normal</option>
                        </select>
                    </div>
                </div>

                <!-- Kesehatan Jiwa -->
                <div>
                    <h4 class="font-semibold text-gray-700 mb-2">Skrining Kesehatan Jiwa</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="date" name="tanggalJiwa" placeholder="Tanggal" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="tempatJiwa" placeholder="Tempat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <select name="hasilJiwa" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Hasil</option>
                            <option value="Normal">Normal</option>
                            <option value="Riwayat Rujuk">Riwayat Rujuk</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Skrining Kanker (Wanita) -->
            <div class="form-section" id="skriningKanker" style="display: none;">
                <h3 class="section-title">Riwayat Skrining Kanker (Wanita)</h3>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Skrining Kanker Payudara</label>
                    <select name="kankerPayudara" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <option value="">Pilih</option>
                        <option value="Ada Benjolan">Ada Benjolan</option>
                        <option value="Tidak Ada Benjolan">Tidak Ada Benjolan</option>
                    </select>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-700 mb-2">Skrining Kanker Serviks (35-59 th, sudah menikah)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <select name="kankerServiks" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Status</option>
                            <option value="Ya">Ya</option>
                            <option value="Tidak">Tidak</option>
                        </select>
                        <input type="date" name="terakhirPeriksaServiks" placeholder="Terakhir Periksa" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <!-- Kepatuhan Pengobatan -->
            <div class="form-section">
                <h3 class="section-title">Kepatuhan Pengobatan</h3>
                
                <!-- Hipertensi -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-2">Hipertensi</h4>
                    <div class="space-y-3">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="date" name="tanggalDiagnosisHipertensi" placeholder="Tanggal Diagnosis" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <input type="text" name="tempatDiagnosisHipertensi" placeholder="Tempat Diagnosis" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <input type="text" name="hasilDiagnosisHipertensi" placeholder="Hasil TD" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <select name="kontrolHipertensi" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Kontrol Setiap Bulan</option>
                                <option value="Ya">Ya</option>
                                <option value="Tidak">Tidak</option>
                            </select>
                            <select name="minumObatHipertensi" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Minum Obat Hari Ini</option>
                                <option value="Ya">Ya</option>
                                <option value="Tidak">Tidak</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Diabetes -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-2">Diabetes Mellitus</h4>
                    <div class="space-y-3">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="date" name="tanggalDiagnosisDM" placeholder="Tanggal Diagnosis" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <input type="text" name="tempatDiagnosisDM" placeholder="Tempat Diagnosis" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <input type="text" name="hasilDiagnosisDM" placeholder="Hasil GDS" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <select name="kontrolDM" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Kontrol Setiap Bulan</option>
                                <option value="Ya">Ya</option>
                                <option value="Tidak">Tidak</option>
                            </select>
                            <select name="minumObatDM" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Minum Obat Hari Ini</option>
                                <option value="Ya">Ya</option>
                                <option value="Tidak">Tidak</option>
                            </select>
                            <input type="text" name="namaObatDM" placeholder="Nama Obat" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Kesehatan Jiwa -->
                <div>
                    <h4 class="font-semibold text-gray-700 mb-2">Kesehatan Jiwa</h4>
                    <div class="space-y-3">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="date" name="tanggalPemeriksaanJiwa" placeholder="Tanggal Pemeriksaan" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <input type="text" name="tempatPemeriksaanJiwa" placeholder="Tempat Pemeriksaan" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <input type="text" name="hasilPemeriksaanJiwa" placeholder="Hasil" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <select name="adaObatJiwa" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Ada Obat/Terapi</option>
                                <option value="Ada">Ada</option>
                                <option value="Tidak">Tidak</option>
                            </select>
                            <select name="terapiTeratur" class="p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Minum Obat/Terapi Teratur</option>
                                <option value="Ya">Ya</option>
                                <option value="Tidak">Tidak</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Perilaku dan Gaya Hidup -->
            <div class="form-section">
                <h3 class="section-title">Perilaku dan Gaya Hidup</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kontrasepsi yang Digunakan</label>
                        <select name="kontrasepsi" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="Pil">Pil</option>
                            <option value="Kondom">Kondom</option>
                            <option value="Suntik">Suntik</option>
                            <option value="Implan/Susuk">Implan/Susuk</option>
                            <option value="Lainnya">Lainnya</option>
                            <option value="Tidak Menggunakan">Tidak Menggunakan</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Perilaku Merokok</label>
                        <select name="perilakuMerokok" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="Aktif">Aktif</option>
                            <option value="Pasif">Pasif</option>
                            <option value="Tidak">Tidak</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Isi Piringku (Keragaman Gizi)</label>
                        <select name="isiPiringku" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="Sesuai">Sesuai</option>
                            <option value="Tidak Sesuai">Tidak Sesuai</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tindakan Kader</label>
                        <select name="tindakanKader" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">Pilih</option>
                            <option value="Apresiasi">Apresiasi</option>
                            <option value="Edukasi">Edukasi</option>
                            <option value="Rujukan">Rujukan</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="text-center">
                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-lg text-lg transition duration-300 shadow-lg">
                    📋 Kirim Data ke Spreadsheet
                </button>
            </div>
        </form>

        <!-- Status Message -->
        <div id="statusMessage" class="mt-6 p-4 rounded-lg text-center hidden"></div>


    </div>

    <script>
        // Show/hide cancer screening section based on gender
        document.querySelector('select[name="jenisKelamin"]').addEventListener('change', function() {
            const skriningKanker = document.getElementById('skriningKanker');
            if (this.value === 'Perempuan') {
                skriningKanker.style.display = 'block';
            } else {
                skriningKancer.style.display = 'none';
            }
        });

        // Form submission
        document.getElementById('checklistForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const statusMessage = document.getElementById('statusMessage');
            statusMessage.className = 'mt-6 p-4 rounded-lg text-center bg-blue-100 text-blue-800';
            statusMessage.textContent = '📤 Mengirim data ke spreadsheet...';
            statusMessage.classList.remove('hidden');

            // Collect form data
            const formData = new FormData(this);
            const data = {};
            
            // Handle regular form fields
            for (let [key, value] of formData.entries()) {
                if (data[key]) {
                    // Handle multiple values (checkboxes)
                    if (Array.isArray(data[key])) {
                        data[key].push(value);
                    } else {
                        data[key] = [data[key], value];
                    }
                } else {
                    data[key] = value;
                }
            }

            // Convert arrays to comma-separated strings
            for (let key in data) {
                if (Array.isArray(data[key])) {
                    data[key] = data[key].join(', ');
                }
            }

            // Add timestamp
            data.timestamp = new Date().toLocaleString('id-ID');

            // URL Google Apps Script untuk mengirim data
            const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzoh3cv7IiSz5lgnZciEBqctJ_3k1g0oMQIElGXhvC-d4JpVA05eH4G1UTHuHun16gEng/exec';

            fetch(APPS_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                statusMessage.className = 'mt-6 p-4 rounded-lg text-center bg-green-100 text-green-800';
                statusMessage.textContent = '✅ Data berhasil dikirim ke spreadsheet!';
                
                // Reset form after successful submission
                setTimeout(() => {
                    this.reset();
                    document.getElementById('skriningKanker').style.display = 'none';
                    statusMessage.classList.add('hidden');
                }, 3000);
            })
            .catch(error => {
                console.error('Error:', error);
                statusMessage.className = 'mt-6 p-4 rounded-lg text-center bg-red-100 text-red-800';
                statusMessage.textContent = '❌ Gagal mengirim data. Silakan coba lagi.';
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'984032f3737acf50',t:'MTc1ODY5NTA2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
